# 🛠️ AWS環境構築演習：NATゲートウェイ＆踏み台構成

## ✅ 概要  
本演習では、以下の構成をAWSで手動構築し、ネットワークの基本理解とSSHの踏み台構成、NAT Gatewayによるインターネット接続の仕組みを学ぶ。  
- パブリックサブネットに踏み台サーバ（EC2 A）を配置  
- プライベートサブネットに本番用サーバ（EC2 B）を配置  
- NAT Gateway経由でプライベートサブネット内のEC2から外部アクセス可能に  
- 踏み台経由でプライベートEC2にSSHログイン

## 🗂️ 構成図
![構成図](./image/diagram.png)


## 🔧 構築手順詳細（抜粋）

### ① VPC作成  
- 東京リージョンで作業  
- 「VPCの作成」 → 名前：`test-vpc`、IPv4 CIDR：`10.0.0.0/21`  
→ `/24`ごとに最大8個のサブネットに分割可能  

### ② サブネット作成  
- パブリックサブネット：`10.0.0.0/24`（例：`test-subnet-a`）  
- プライベートサブネット：`10.0.1.0/24`（例：`test-subnet-b`）

### ③ IGW作成とアタッチ  
- 「インターネットゲートウェイ」 → 作成 → `test-vpc` にアタッチ  

### ④〜⑦ ルートテーブル構成  
- `rtb-subnet-a`：パブリック用、IGW（0.0.0.0/0）ルート追加  
- `rtb-subnet-b`：プライベート用、当初は`local`のみ  

👉 **この構成により、パブリック側EC2はインターネットへ接続可能。プライベート側EC2はまだ外部非接続。**

## ☁️ EC2構築と接続設定（抜粋）

### 踏み台EC2（bastion）  
- パブリックサブネット、パブリックIP付与  
- SG：ポート22開放（自分のIPのみに）  
- Elastic IPをアタッチ  

### プライベートEC2（本番）  
- プライベートサブネット、パブリックIPなし  
- SG：ポート22を「踏み台のSGからのみ許可」  

### SSH接続（2段階）  
1. ローカル → 踏み台（Elastic IP）  
2. 踏み台上に秘密鍵を置いて → プライベートEC2へSSH

```bash
chmod 400 /tmp/my-key.pem
ssh -i /tmp/my-key.pem ec2-user@10.0.1.x

